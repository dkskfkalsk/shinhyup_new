# 📝 구글 앱스크립트 수정 방법 (3단계)

## ⚠️ 반드시 수정이 필요합니다!

현재 코드는 **A열에 빈 값을 넣어서 함수를 덮어쓸 수 있습니다.**
수정된 코드로 교체해야 합니다.

---

## 🔧 3단계 수정 방법

### ✅ 1단계: 새 코드 복사 (1분)

1. **파일 열기**
   - 프로젝트 폴더에서 `GoogleAppsScript_Code_BColumn.js` 파일 열기
   - 또는 위의 마크다운 문서에서 코드 전체 복사

2. **코드 전체 복사**
   - Ctrl+A (전체 선택)
   - Ctrl+C (복사)

---

### ✅ 2단계: Apps Script 편집기에서 교체 (2분)

1. **Apps Script 편집기 열기**
   - 구글 시트 열기
   - **확장 프로그램 > Apps Script** 클릭

2. **기존 코드 삭제**
   - 편집기에서 Ctrl+A (전체 선택)
   - Delete 키 또는 백스페이스로 삭제

3. **새 코드 붙여넣기**
   - Ctrl+V (붙여넣기)

4. **저장**
   - Ctrl+S 또는 **파일 > 저장**
   - 저장 완료 확인

---

### ✅ 3단계: 웹 앱 재배포 (2분) ⚠️ 중요!

**코드를 수정했으면 반드시 웹 앱을 재배포해야 합니다!**

1. **배포 관리 열기**
   - Apps Script 편집기에서 **배포 > 배포 관리** 클릭

2. **기존 배포 수정**
   - 기존 배포 옆 **연필 아이콘(✏️)** 클릭
   - 또는 **새 배포** 클릭

3. **새 버전으로 배포**
   - **버전**: **새 버전** 선택
   - **설명** (선택사항): "B열부터 시작하도록 수정"
   - **배포** 버튼 클릭

4. **Web App URL 복사**
   - 배포 후 표시되는 **Web App URL** 복사
   - 예: `https://script.google.com/macros/s/AKfycby.../exec`

5. **Vercel 환경 변수 업데이트**
   - Vercel 대시보드 접속
   - 프로젝트 선택 → **Settings** → **Environment Variables**
   - `GOOGLE_APPS_SCRIPT_URL` 찾기
   - 값 수정 → 새 URL 붙여넣기
   - 저장

---

## 🔑 주요 변경 사항

### 변경 전 (문제 있음)
```javascript
const row = ['', koreaTime, data.uname, ...];  // A열에 빈 값
sheet.appendRow(row);  // A열부터 시작 → A열 함수 덮어쓸 수 있음
```

### 변경 후 (해결)
```javascript
const rowData = [koreaTime, data.uname, ...];  // A열 제외
const range = sheet.getRange(targetRow, 2, 1, 5);  // B열(2)부터 시작
range.setValues([rowData]);  // A열 건드리지 않음 ✅
```

---

## 📋 변경 사항 요약

| 항목 | 변경 전 | 변경 후 |
|-----|---------|---------|
| **A열** | 빈 값 저장 (함수 덮어쓰기 위험) | 건드리지 않음 ✅ |
| **시작 열** | A열부터 | B열부터 ✅ |
| **행 찾기** | 전체 마지막 행 기준 | B열 기준 ✅ |
| **데이터 저장** | appendRow() | getRange() + setValues() ✅ |

---

## ✅ 확인 사항

수정 후 다음을 확인하세요:

- [ ] Apps Script 코드 교체 완료
- [ ] 웹 앱 재배포 완료
- [ ] Vercel 환경 변수 업데이트 완료
- [ ] 사이트에서 폼 제출 테스트
- [ ] 구글 시트에서 A열 함수 유지 확인
- [ ] B열부터 데이터 저장 확인

---

## 🚨 중요!

**코드를 수정한 후에는 반드시:**
1. ✅ **저장** (Ctrl+S)
2. ✅ **웹 앱 재배포** (배포 > 배포 관리 > 새 버전)
3. ✅ **Vercel 환경 변수 업데이트** (새 URL)

**재배포를 안 하면 변경 사항이 적용되지 않습니다!**

---

## 🆘 문제가 발생하면?

1. **Apps Script 로그 확인**
   - 실행 > 로그 (Ctrl+Enter)
   - 오류 메시지 확인

2. **웹 앱 URL 테스트**
   - 브라우저에서 Web App URL 직접 접속
   - JSON 응답이 나오는지 확인

3. **Vercel 로그 확인**
   - Functions 탭에서 로그 확인
   - 오류 메시지 확인

---

**총 소요 시간: 약 5분**

**이제 A열의 함수를 건드리지 않고 B열부터 데이터가 저장됩니다!** 🎉

