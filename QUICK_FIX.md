# ⚡ 빠른 해결 방법 (5분 안에 해결!)

Google Apps Script 코드를 실행한 후 전송 오류가 발생하는 경우, **90%의 확률로 다음 중 하나입니다.**

## 🚨 가장 흔한 원인 3가지

### 1️⃣ 웹 앱 재배포 누락 (가장 흔함!)

**문제:** `setupScriptProperties()` 실행 후 **웹 앱을 재배포하지 않았습니다!**

**해결 방법:**
1. Apps Script 편집기 → **배포 > 배포 관리**
2. 기존 배포 옆 **연필 아이콘(✏️)** 클릭
3. **새 버전** 선택
4. **배포** 클릭
5. 새 URL을 Vercel 환경 변수 `GOOGLE_APPS_SCRIPT_URL`에 업데이트

⏰ **재배포만 하면 즉시 해결됩니다!**

---

### 2️⃣ 토큰 불일치

**문제:** Apps Script의 SECRET_TOKEN과 Vercel 환경 변수가 다릅니다.

**해결 방법:**

#### Apps Script에서 토큰 확인
1. Apps Script 편집기에서 함수 선택: `checkConfig`
2. **실행** 클릭
3. **실행 > 로그** 확인 → 토큰이 `121217`인지 확인

#### Vercel에서 토큰 설정
1. Vercel 대시보드 → 프로젝트 → **Settings** → **Environment Variables**
2. `GOOGLE_APPS_SCRIPT_TOKEN` 값이 **`121217`**인지 확인
3. 다르면 수정하고 저장

---

### 3️⃣ 배포 설정 오류

**문제:** 웹 앱 배포 시 접근 권한이 잘못 설정되었습니다.

**해결 방법:**
1. Apps Script 편집기 → **배포 > 배포 관리**
2. 기존 배포 삭제
3. **배포 > 새 배포** 클릭
4. 다음 설정으로 새로 배포:
   - **종류 선택**: 웹 앱
   - **다음 사용자 인증 정보로 실행**: **나** ⬅️
   - **엑세스 권한이 있는 사용자**: **모든 사용자** ⬅️
5. 배포 후 URL을 Vercel 환경 변수에 업데이트

---

## 📋 5분 체크리스트

다음 순서대로 확인하세요:

- [ ] **1단계**: Apps Script 편집기에서 `checkConfig()` 실행 → 로그 확인
- [ ] **2단계**: 웹 앱 **재배포** (배포 > 배포 관리 > 기존 배포 수정 > 새 버전 > 배포)
- [ ] **3단계**: Vercel 환경 변수 확인:
  - `GOOGLE_APPS_SCRIPT_URL` → 재배포한 새 URL
  - `GOOGLE_APPS_SCRIPT_TOKEN` → `121217`
- [ ] **4단계**: Web App URL 브라우저에서 직접 접속 테스트 (JSON 응답 확인)
- [ ] **5단계**: 사이트에서 폼 제출 테스트

---

## 🧪 빠른 테스트 방법

### Web App URL 직접 테스트

브라우저에서 다음 URL 접속 (YOUR_DEPLOYMENT_ID는 실제 배포 ID로 변경):
```
https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec
```

**정상:** JSON 응답이 보임
**오류:** 로그인 페이지나 오류 페이지 → 배포 설정 확인

### Apps Script 로그 확인

1. Apps Script 편집기 → **실행 > 로그** (Ctrl+Enter)
2. 폼 제출 시도
3. 로그에서 오류 메시지 확인:
   - `❌ 토큰 불일치!` → 토큰 확인
   - `❌ 시트 접근 실패` → 시트 ID 확인
   - `✅ 모든 과정 성공` → 성공!

---

## ⚡ 가장 빠른 해결 순서

1. **웹 앱 재배포** (1분)
   - 배포 > 배포 관리 > 기존 배포 수정 > 새 버전 > 배포
   
2. **Vercel 환경 변수 확인** (1분)
   - `GOOGLE_APPS_SCRIPT_URL` 업데이트
   - `GOOGLE_APPS_SCRIPT_TOKEN`이 `121217`인지 확인

3. **테스트** (1분)
   - 사이트에서 폼 제출

**총 3분이면 해결됩니다!** 🎉

---

## 🆘 그래도 안 되면?

1. **Apps Script 로그 전체 내용** 복사
2. **Vercel 로그** 확인 (Functions 탭)
3. **오류 메시지 전체** 복사

위 내용을 가지고 더 자세한 문제 해결을 진행하세요.

